<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Derivada</title>
</head>
<body>

<h1>Calculadora de Derivadas</h1>


<div>
    <button onclick="insertar('x')">x</button>
    <button onclick="insertar('^')">^</button>
    <button onclick="insertar('+')">+</button>
    <button onclick="insertar('-')">-</button>
    <button onclick="insertar('*')">*</button>
    <button onclick="insertar('/')">/</button>
    <button onclick="insertar('(')">(</button>
    <button onclick="insertar(')')">)</button>
</div>

<br>
<input id="entrada" type="text" placeholder="Ingresa la derivada" style="width: 300px; font-size: 16px;">

<button onclick="resolver()">Resolver derivada</button>

<h2>Resultado:</h2>
<p id="resultado"></p>

<script>

function insertar(simbolo) {
    const campo = document.getElementById("entrada");
    campo.value += simbolo;
    campo.focus();
}
function derivarTermino(t) {


    t = t.trim();


    if (!t.includes("x")) {
        return "0";
    }


    if (t === "x") return "1";


    let coef = "";
    let exp = "";
    if (t.includes("^")) {
        coef = t.split("x")[0];
        exp = t.split("^")[1];
    } 
    else {

        coef = t.split("x")[0];
        exp = "1";
    }


    if (coef === "" || coef === "+") coef = "1";
    if (coef === "-") coef = "-1";

    coef = Number(coef);
    exp = Number(exp);


    let nuevoCoef = coef * exp;
    let nuevoExp = exp - 1;

    if (nuevoExp === 1) return nuevoCoef + "x";
    if (nuevoExp === 0) return "" + nuevoCoef;
    
    return nuevoCoef + "x^" + nuevoExp;
}


function resolver() {
    let fun = document.getElementById("entrada").value;

    fun = fun.replace(/-/g, "+-");

    const terminos = fun.split("+").filter(t => t !== "");

    let derivados = terminos.map(derivarTermino);


    let resultado = derivados.join(" + ");


    resultado = resultado.replace(/\+ -/g, "- ");

    document.getElementById("resultado").innerText = resultado;
}
</script>

</body>
</html>